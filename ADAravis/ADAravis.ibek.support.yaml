 # yaml-language-server: $schema=https://github.com/epics-containers/ibek/releases/download/1.1.0/ibek.support.schema.json

module: ADAravis

defs:

- name: iocbuilder.modules.ADAravis.aravisCamera
  description: |-
    Creates a aravisCamera camera areaDetector driver

  args:
  - type: str
    name: P
    description: PV Prefix
  - type: str
    name: R
    description: PV Suffix
  - type: id
    name: PORT
    description: Port name for the camera
  - type: str
    name: ID
    description: Cam ip address, hostname, MAC address, or ID <manufacturer>-<serial>,
      (e.g. Prosilica-02-2166A-06844)
  - type: enum
    name: CLASS
    description: Camera class for custom commands
  - type: enum
    name: PV_ALIAS
    description: Use alias template to keep some key PV names the same
  - type: int
    name: BUFFERS
    description: Maximum number of NDArray buffers to be created for plugin callbacks
    default: 50
  - type: int
    name: MEMORY
    description: Max memory to allocate, should be maxw*maxh*nbuffer for driver and
      all attached plugins
    default: -1

  databases:
  - file: $(ADARAVIS)/db/aravisCamera.template
    args:  # TODO - MISSING ARGS: ADDR, TIMEOUT
      P:
      R:
      ADDR:
      TIMEOUT:
      PORT:
  - file: $(ADGENICAM)/db/AVT_Mako_1_52.template
    args:  # TODO - MISSING ARGS: ADDR, TIMEOUT
      P:
      R:
      ADDR:
      TIMEOUT:
      PORT:

  pre_init:
  - type: text
    value: |
      aravisConfig(const char *portName, const char *cameraName, size_t maxMemory, int priority, int stackSize)
      aravisConfig("{{PORT}}", "{{ID}}", {{MEMORY}}, 0, 1)
